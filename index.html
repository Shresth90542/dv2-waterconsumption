<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Malaysia Water — Production & Consumption Dashboard</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">

  <!-- Vega libraries -->
  <script src="https://cdn.jsdelivr.net/npm/vega@5"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-lite@6"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script>

  <!-- Styles -->
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <header class="masthead">
    <div class="wrap masthead__inner">
      <div class="masthead__titles">
        <h1>Malaysia Water — Production &amp; Consumption</h1>
        <p class="subtitle">Trends, sector mix, state comparisons &amp; geospatial patterns (2000–2022)</p>
      </div>
      <span class="badge">Interactive</span>
    </div>
  </header>

  <main class="wrap">

    <!-- Insights (short, executive-summary style) -->
    <section class="card insights">
      <h2 class="sr-only">Insights</h2>
      <p>
        Selangor dominates total demand, followed by Johor and Perak. National production rose steadily
        from 2000–2019, keeping pace with urban growth. Stacked bars show domestic use as the largest share,
        while non-domestic demand has expanded post-2010. Most states sit close to the production=consumption
        line, indicating tight balance. Long-run state trends are upward, with Selangor’s growth most pronounced.
      </p>
    </section>

    <!-- 1) MAP — first, larger card -->
    <section class="card">
      <div id="map_totals" class="viz viz--lg"></div>
      <p class="caption">
        Darker shades indicate higher total consumption (MLD) by state. Hover for exact values.
      </p>
    </section>

    <!-- 2) National Water Production -->
    <section class="card">
      <div id="line" class="viz"></div>
      <p class="caption">
        National production shows steady long-run growth (2000–2019); year-to-year bumps reflect new capacity and demand.
      </p>
    </section>

    <!-- 3–4) State comparisons -->
    <section class="grid grid-2">
      <div class="card">
        <div id="bars" class="viz viz--sm"></div>
        <p class="caption">
          Split of <em>Domestic</em> vs <em>Non-domestic</em> consumption by state for a selected year (use the slider).
        </p>
      </div>
      <div class="card">
        <div id="scatter" class="viz viz--sm"></div>
        <p class="caption">
          Each dot is a state; points above the 45° line indicate production &gt; consumption (surplus), below indicates deficit.
        </p>
      </div>
    </section>

    <!-- 5) Area (sector over time) -->
    <section class="card">
      <div id="area" class="viz"></div>
      <p class="caption">
        Domestic remains the majority share; non-domestic grows notably after 2010, mirroring industrial/commercial activity.
      </p>
    </section>

    <!-- 6) State trend (single-state clean line) -->
    <section class="card">
      <div id="sparklines" class="viz"></div>
      <p class="caption">
        Choose a state from the dropdown inside the chart to view its clean trend line (MLD).
      </p>
    </section>

    <!-- 7) Dumbbell change view -->
    <section class="card">
      <div id="dumbbell" class="viz viz--sm"></div>
      <p class="caption">
        Compare two years with the sliders; lines show magnitude &amp; direction of change by state (sorted by largest shift).
      </p>
    </section>
  </main>

  <footer class="site-footer">
    <div class="wrap site-footer__inner">
      <p>
        <strong>Data sources:</strong>
        <code>water_production_2000_2019.csv</code>,
        <code>water_consumption.csv</code>,
        <code>state_totals.csv</code>
      </p>
      <p>Prepared by <strong>Shresth Sohaney</strong> (Student ID: <strong>33806314</strong>)</p>
    </div>
  </footer>

  <script>
    // New map first (keeps your working spec)
    vegaEmbed('#map_totals', 'map_totals.json', { actions: false, renderer: 'canvas' }).catch(console.error);

    // Existing charts
    vegaEmbed('#line', 'linechart.json', { actions: false, renderer: 'canvas' }).catch(console.error);
    vegaEmbed('#bars', 'bars.json', { actions: false, renderer: 'canvas' }).catch(console.error);
    vegaEmbed('#scatter', 'scatter.json', { actions: false, renderer: 'canvas' }).catch(console.error);
    vegaEmbed('#area', 'area.json', { actions: false, renderer: 'canvas' }).catch(console.error);
    vegaEmbed('#sparklines', 'state_sparklines.json', { actions: false, renderer: 'canvas' }).catch(console.error);
    vegaEmbed('#dumbbell', 'change_dumbbell.json', { actions: false, renderer: 'canvas' }).catch(console.error);
  </script>
</body>
</html>
