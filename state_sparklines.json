{
  "$schema": "https://vega.github.io/schema/vega-lite/v6.json",
  "title": {
    "text": "Water Consumption Trend by State (2003â€“2022)",
    "fontSize": 18,
    "fontWeight": "bold",
    "anchor": "start"
  },
  "width": 900,
  "height": 400,
  "data": {
    "url": "https://raw.githubusercontent.com/Shresth90542/dv2-waterconsumption/main/water_consumption.csv",
    "format": {"type": "csv"}
  },
  "params": [
    {
      "name": "state_select",
      "bind": {
        "input": "select",
        "options": [
          "Johor", "Kedah", "Kelantan", "Melaka", "Negeri Sembilan",
          "Pahang", "Perak", "Perlis", "Pulau Pinang", "Sabah",
          "Sarawak", "Selangor", "Terengganu", "W.P. Labuan"
        ],
        "labels": [
          "Johor", "Kedah", "Kelantan", "Melaka", "Negeri Sembilan",
          "Pahang", "Perak", "Perlis", "Pulau Pinang", "Sabah",
          "Sarawak", "Selangor", "Terengganu", "W.P. Labuan"
        ],
        "name": "Choose State: "
      },
      "value": "Selangor"
    }
  ],
  "transform": [
    {"calculate": "year(toDate(datum.date))", "as": "Year"},
    {"filter": "datum.state == state_select"},
    {"aggregate": [{"op": "sum", "field": "value", "as": "Total"}], "groupby": ["Year"]}
  ],
  "layer": [
    {
      "mark": {"type": "area", "opacity": 0.15, "color": "#2563eb"}
    },
    {
      "mark": {"type": "line", "stroke": "#2563eb", "strokeWidth": 3, "interpolate": "monotone"}
    },
    {
      "mark": {"type": "point", "filled": true, "color": "#1e40af", "size": 60}
    }
  ],
  "encoding": {
    "x": {
      "field": "Year",
      "type": "quantitative",
      "axis": {"title": "Year", "tickCount": 6, "labelAngle": 0}
    },
    "y": {
      "field": "Total",
      "type": "quantitative",
      "axis": {"title": "Total Consumption (MLD)", "grid": true}
    },
    "tooltip": [
      {"field": "Year", "type": "ordinal", "title": "Year"},
      {"field": "Total", "type": "quantitative", "title": "Consumption (MLD)"}
    ]
  },
  "config": {
    "view": {"stroke": null},
    "axis": {"domainColor": "#e5e7eb", "tickColor": "#e5e7eb"},
    "background": "white"
  }
}
